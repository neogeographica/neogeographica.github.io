(function(b){var a;a=b.fn.galleria=function(e){if(!a.hasCSS()){return false}this.each(function(){b(this).children("li").each(function(k){var j=b(this).find("a").is("a")?b(this).find("a"):false;if(j){j.click(function(){return false})}})});var h={insert:".galleria_container",clickNext:true,onImage:function(j,i){},onThumb:function(i){}};var f=b.extend(h,e);for(var g in f){if(g){b.galleria[g]=f[g]}}var d=(b(f.insert).is(f.insert))?b(f.insert):jQuery(document.createElement("div")).insertBefore(this);var c=b(document.createElement("div")).addClass("galleria_wrapper");d.addClass("galleria_container").append(c);return this.each(function(){b(this).addClass("galleria");var i=b(this).attr("class").match(/\bgalleria_instance_\S+/);if(!i){i=""}else{i="."+i}b(this).children("li").each(function(p){var l=b(this);var j=b.meta?b.extend({},f,l.data()):f;j.clickNext=b(this).is(":only-child")?false:j.clickNext;var o=b(this).find("a").is("a")?b(this).find("a"):false;var k=b(this).children("img").css("display","none");var q=o?o.attr("href"):k.attr("src");var n=o?o.attr("title"):k.attr("title");var m=new Image();b(m).load(function(){b(this).attr("alt",k.attr("alt"));var t=o?o.find("img").addClass("thumb noscale").css("display","none"):k.clone(true).addClass("thumb").css("display","none");if(o){o.replaceWith(t)}if(!t.hasClass("noscale")){var r=Math.ceil(k.width()/k.height()*l.height());var s=Math.ceil(k.height()/k.width()*l.width());if(r<s){t.css({height:"auto",width:l.width(),marginTop:-(s-l.height())/2})}else{t.css({width:"auto",height:l.height(),marginLeft:-(r-l.width())/2})}}else{window.setTimeout(function(){t.css({marginLeft:-(t.width()-l.width())/2,marginTop:-(t.height()-l.height())/2})},1)}t.attr("rel",q);t.attr("title",n);t.click(function(){b.galleria.activate(q,i)});t.hover(function(){b(this).addClass("hover")},function(){b(this).removeClass("hover")});l.hover(function(){l.addClass("hover")},function(){l.removeClass("hover")});l.prepend(t);t.css("display","block");j.onThumb(jQuery(t));if(l.hasClass("active")){b.galleria.activate(q,i)}k.remove()}).error(function(){l.html('<span class="error" style="color:red">Error loading image: '+q+"</span>")}).attr("src",q)})})};a.nextSelector=function(c){return b(c).is(":last-child")?b(c).siblings(":first-child"):b(c).next()};a.previousSelector=function(c){return b(c).is(":first-child")?b(c).siblings(":last-child"):b(c).prev()};a.hasCSS=function(){b("body").append(b(document.createElement("div")).attr("id","css_test").css({width:"1px",height:"1px",display:"none"}));var c=(b("#css_test").width()!=1)?false:true;b("#css_test").remove();return c};a.onPageLoad=function(g,f){var d=b("div"+f+" > .galleria_wrapper");var e=b(".galleria"+f+' img[rel="'+g+'"]');if(g){e.parents("li").siblings(".active").removeClass("active");e.parents("li").addClass("active");var c=b(new Image()).attr("src",g).addClass("replaced");d.empty().append(c);b.galleria.onImage(c,e);if(b.galleria.clickNext){c.css("cursor","pointer").click(function(){b.galleria.next(f)})}}else{d.siblings().andSelf().empty();b(".galleria"+f+" li.active").removeClass("active")}b.galleria.current[f]=g};b.extend({galleria:{current:[],activate:function(d,c){a.onPageLoad(d,c)},next:function(d){var c=b(a.nextSelector(b(".galleria"+d+' img[rel="'+b.galleria.current[d]+'"]').parents("li"))).find("img").attr("rel");b.galleria.activate(c,d)},prev:function(d){var c=b(a.previousSelector(b(".galleria"+d+' img[rel="'+b.galleria.current[d]+'"]').parents("li"))).find("img").attr("rel");b.galleria.activate(c,d)}}})})(jQuery);jQuery(document).ready(function(){jQuery(".gallery_noscript").remove();jQuery(".gallery").addClass("gallery_galleria");jQuery(".gallery_display").addClass("gallery_display_galleria");jQuery(".gallery_1rowthumbs").addClass("gallery_1rowthumbs_galleria");jQuery(".gallery_2rowthumbs").addClass("gallery_2rowthumbs_galleria")});jQuery(function(a){jQuery("ul.thumbnail_picker").galleria({clickNext:true,insert:".gallery_display",onImage:function(d,b){if(!(a.browser.mozilla&&navigator.appVersion.indexOf("Win")!=-1)){d.css("display","none").fadeIn(500)}var c=b.parents("li");c.siblings().children("img.selected").removeClass("selected").fadeTo(500,0.3);b.fadeTo("fast",1).addClass("selected")},onThumb:function(b){var d=b.parents("li");var c=d.is(".active")?"1":"0.3";b.css({display:"none",opacity:c}).fadeIn(1500);b.hover(function(){b.fadeTo("fast",1)},function(){d.not(".active").children("img").fadeTo("fast",0.3)})}})});